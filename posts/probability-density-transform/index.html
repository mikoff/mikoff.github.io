<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Aleksandr Mikoff"><meta name=twitter:card content="summary"><meta name=twitter:title content="Probability density transform"><meta name=twitter:description content="PDF transformations While reading new [book]1 by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]2, [3]3, [4]4, [5]5.
Introduction Assume that we have random variable $X$ that has a continuous distribution on an interval $S \in \mathcal{R}$, its probability density function $f(x)$ is known."><meta property="og:title" content="Probability density transform"><meta property="og:description" content="PDF transformations While reading new [book]1 by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]2, [3]3, [4]4, [5]5.
Introduction Assume that we have random variable $X$ that has a continuous distribution on an interval $S \in \mathcal{R}$, its probability density function $f(x)$ is known."><meta property="og:type" content="article"><meta property="og:url" content="https://mikoff.github.io/posts/probability-density-transform/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-27T12:00:00+03:00"><meta property="article:modified_time" content="2024-01-27T12:00:00+03:00"><base href=https://mikoff.github.io/posts/probability-density-transform/><title>Probability density transform · Aleksandr Mikoff's blog
</title><link rel=canonical href=https://mikoff.github.io/posts/probability-density-transform/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.11.2/css/all.css integrity=sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://mikoff.github.io/fontdata/css/academicons.min.css><link rel=stylesheet href=https://mikoff.github.io/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://mikoff.github.io/css/coder-dark.min.83a2010dac9f59f943b3004cd6c4f230507ad036da635d3621401d42ec4e2835.css integrity="sha256-g6IBDayfWflDswBM1sTyMFB60DbaY102IUAdQuxOKDU=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://mikoff.github.io/css/image.css><link rel=stylesheet href=https://mikoff.github.io/css/spoiler.css><link rel=icon type=image/png href=https://mikoff.github.io/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://mikoff.github.io/img/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.122.0"></head><body class=colorscheme-auto><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://mikoff.github.io/>Aleksandr Mikoff's blog
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://mikoff.github.io/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://mikoff.github.io/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=https://mikoff.github.io/tags>Tags</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Probability density transform</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i>
<time datetime=2024-01-27T12:00:00+03:00>January 27, 2024
</time></span><span class=reading-time><i class="fas fa-clock"></i>
7-minute read</span></div><div class=tags><i class="fas fa-tag"></i>
<a href=https://mikoff.github.io/tags/pdf/>pdf</a>
<span class=separator>•</span>
<a href=https://mikoff.github.io/tags/probability/>probability</a>
<span class=separator>•</span>
<a href=https://mikoff.github.io/tags/transform/>transform</a>
<span class=separator>•</span>
<a href=https://mikoff.github.io/tags/deep-learning/>deep learning</a></div></div></header><div><h1 id=pdf-transformations>PDF transformations</h1><p>While reading new [book]<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, [3]<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, [4]<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>, [5]<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>.</p><h2 id=introduction>Introduction</h2><p>Assume that we have random variable $X$ that has a continuous distribution on an interval $S \in \mathcal{R}$, its probability density function $f(x)$ is known. Suppose that we have a differentiable function $y$ from $S$ to $T \in \mathcal{R}$ and we apply this function to random variable $X$. We end up having a new random variable $Y = y(X)$. The question is how can we find the distribution of our random variable $Y$?</p><h2 id=the-main-theorem>The main theorem</h2><p>We know, by definition of probability that:
$$
P(a \leq X &lt; b) = \int_a^b f(x) dx.
$$</p><p>Now, if $X = a$ the derived random variable $Y = y(a)$ and if $X = b$, $Y = y(b)$. Hence:
$$
P(y(a) \leq Y &lt; y(b)) = P(a \leq X &lt; b) = \int_a^b f(x)dx = \int_{y(a)}^{y(b)}f(x(y))\frac{dx}{dy} dy.
$$
In the last step we used the integration by substitution method, $x(y)$ is $x$ expressed in terms of $y$.</p><p>The right-hand integrand $f(x(y))\frac{dx}{dy}$ is expressed wholly in terms of y, so can be replaced by function $g(y)$:
$$
P(y(a) \leq Y &lt; y(b)) = \int_{y(a)}^{y(b)} g(y) dy,
$$
making it obvious that $g(y)$ is the pdf associated with $Y$.</p><p>Now, taking the derivative, we have
$$
g(y) = f(x(y)) \left|\frac{dx}{dy}\right|.
$$
Here we have an absolute value because the formula is the same for increasing or decreasing $g$.</p><p>While being compact, this formula is less clear. We must remember that $x$ on the ride side should be written in terms of $y$, but since we originally express $y$ in terms of $x$: $Y = y(X)$, the inverse function should be used there.</p><p>To be a little bit more explicit let&rsquo;s rewrite this equation using arbitrary function $r$: $y = r(x)$ applied to variable $x$, and giving back variable $y$, the aforementioned formula can be rendered as follows:
$$
g(y) = f(r^{-1}(y))\left|\frac{d}{dy}r^{-1}(y)\right|.
$$</p><p>What this formula states is that any density $g(y)$ can be obtained from a fixed density $f(x)$.</p><h3 id=example-1>Example 1</h3><p>Suppose that $Y = a + bX$, $a \in \mathcal{R}$ and $b \in \mathcal{R} \backslash {0}$, the distribution of $X$ is known: $f(x)$. What is the pdf of $Y$?</p><p>Since $r(x) = y = a + bx$, we can find inverse function to be $r^{-1}(y) = x = \frac{y - a}{b}$ and the derivative $\frac{dx}{dy} = \frac{1}{b}$.</p><p>Then $g(y) = f(\frac{y - a}{b})\frac{1}{|b|}$.</p><h3 id=example-2>Example 2</h3><p>Suppose that $f(x) = 2 x, x \in [0, 1)$ and $y(x) = x^2$.</p><p>First, derive the inverse of the function $x(y) = \sqrt{y}$.</p><p>Now, having:</p><p>$$
\begin{align}
f(x(y)) = 2 \sqrt{y}~\text{and}~ \frac{dx}{dy} = \frac{1}{2\sqrt{y}}
\end{align}
$$
we can find $g(y)$ to be:</p><p>$$
g(y) = f(x(y)) \left|\frac{dx}{dy}\right| = 2 \sqrt{y} \frac{1}{2\sqrt{y}} = 1.
$$
So after applying transformation $y(x) = x^2$ to random variable $X$ the function $y(x)$ transforms the triangular distribution into the uniform one.</p><h3 id=example-3>Example 3</h3><p>Given random variable $X \sim \mathcal{N}(6.5, 1.)$ we apply to it transformation function $y(x)$ specified as:
$$
y(x) = \frac{1}{1 + \exp(5 - x)}.
$$
Let $Y = y(X)$, and $p(y)$ be the pdf associated with $Y$. What is the pdf of $p(y)$?</p><p>Let&rsquo;s solve the problem using <code>sympy</code>:</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>sympy</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>sp</span>
</span></span><span style=display:flex><span>x <span style=color:#555>=</span> sp<span style=color:#555>.</span>Symbol(<span style=color:#c30>&#39;x&#39;</span>, positive<span style=color:#555>=</span><span style=color:#069;font-weight:700>True</span>)
</span></span><span style=display:flex><span>y <span style=color:#555>=</span> sp<span style=color:#555>.</span>Symbol(<span style=color:#c30>&#39;y&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>y_x <span style=color:#555>=</span> <span style=color:#f60>1.</span> <span style=color:#555>/</span> (<span style=color:#f60>1.</span> <span style=color:#555>+</span> sp<span style=color:#555>.</span>exp(<span style=color:#f60>5</span> <span style=color:#555>-</span> x))
</span></span><span style=display:flex><span>x_y <span style=color:#555>=</span> sp<span style=color:#555>.</span>solve(y_x <span style=color:#555>-</span> y, x)[<span style=color:#f60>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dx_dy <span style=color:#555>=</span> x_y<span style=color:#555>.</span>diff(y)<span style=color:#555>.</span>simplify()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># print(sp.latex(x_y), sp.latex(dx_dy))</span>
</span></span></code></pre></div></div></div><p>After solving for $y$ and finding the derivative we got:
$$
\begin{align}
x(y) = \log{\left(- \frac{y}{y - 1.0} \right)} + 5.0 ~\text{and}~ \frac{dx}{dy} = -\frac{1.0}{y \left(y - 1\right)}
\end{align}
$$</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>sympy.stats</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>X <span style=color:#555>=</span> sp<span style=color:#555>.</span>stats<span style=color:#555>.</span>Normal(<span style=color:#c30>&#39;x&#39;</span>, <span style=color:#f60>6.5</span>, <span style=color:#f60>1</span>)
</span></span><span style=display:flex><span>pdf_x <span style=color:#555>=</span> sp<span style=color:#555>.</span>stats<span style=color:#555>.</span>density(X)(x)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pdf_y_simple_transform <span style=color:#555>=</span> pdf_x<span style=color:#555>.</span>subs({x:x_y})
</span></span><span style=display:flex><span>pdf_y <span style=color:#555>=</span> (pdf_x <span style=color:#555>*</span> dx_dy)<span style=color:#555>.</span>subs({x:x_y})
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># print(sp.latex(pdf_y))</span>
</span></span></code></pre></div></div></div><p>Giving the following $p(y)$:
$$
p(y) = - \frac{0.5 \sqrt{2} e^{- 1.125 \left(0.666666666666667 \log{\left(- \frac{y}{y - 1.0} \right)} - 1\right)^{2}}}{\sqrt{\pi} y \left(y - 1\right)}
$$</p><p>Now let&rsquo;s plot everything. First let&rsquo;s plot $p(x)$ and draw samples from $X$ distribution, plotting the histogram of their values (blue).</p><p>Next, let&rsquo;s apply the function $y(x)$ to each sample from the drawn set and plot its histogram too (orange).</p><p>If we substitute $x$ by $y$ in $p(x)$, we will obtain a purple curve. However, this curve does not agree with the histogram!</p><p>The correct curve for $p(y)$ density is shown in orange. In this case, in addition to substitution, we multiplied the result by $\frac{dx}{dy}$ to obtain the correct result.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>numpy</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>np</span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>from</span> <span style=color:#0cf;font-weight:700>scipy.stats</span> <span style=color:#069;font-weight:700>import</span> norm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># lambdify pdfs</span>
</span></span><span style=display:flex><span>p_x <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(x, pdf_x)
</span></span><span style=display:flex><span>p_y_simple_transform <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(y, pdf_y_simple_transform)
</span></span><span style=display:flex><span>p_y <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(y, pdf_y)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># lambdify functions</span>
</span></span><span style=display:flex><span>y_x_func <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(x, y_x, modules <span style=color:#555>=</span> [<span style=color:#c30>&#34;numpy&#34;</span>])
</span></span><span style=display:flex><span>x_y_func <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(y, x_y)
</span></span><span style=display:flex><span>dx_dy_func <span style=color:#555>=</span> sp<span style=color:#555>.</span>lambdify(y, dx_dy)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x_interval <span style=color:#555>=</span> np<span style=color:#555>.</span>arange(<span style=color:#f60>0</span>, <span style=color:#f60>10</span>, <span style=color:#f60>0.1</span>)
</span></span><span style=display:flex><span>y_interval <span style=color:#555>=</span> np<span style=color:#555>.</span>linspace(<span style=color:#f60>0.0</span>, <span style=color:#f60>1.0</span>, <span style=color:#f60>1000</span>, endpoint<span style=color:#555>=</span><span style=color:#069;font-weight:700>False</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># sample X from our distribution</span>
</span></span><span style=display:flex><span>X_sampled <span style=color:#555>=</span> norm(<span style=color:#f60>6.5</span>, <span style=color:#f60>1.</span>)<span style=color:#555>.</span>rvs(size <span style=color:#555>=</span> <span style=color:#f60>100000</span>)
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># transform the values</span>
</span></span><span style=display:flex><span>Y <span style=color:#555>=</span> y_x_func(X_sampled)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>matplotlib.pyplot</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>plt</span>
</span></span><span style=display:flex><span><span style=color:#555>%</span>matplotlib inline
</span></span><span style=display:flex><span><span style=color:#555>%</span>config InlineBackend<span style=color:#555>.</span>figure_format<span style=color:#555>=</span><span style=color:#c30>&#39;retina&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, ax <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplots(<span style=color:#f60>1</span>, <span style=color:#f60>1</span>, figsize<span style=color:#555>=</span>(<span style=color:#f60>6</span>, <span style=color:#f60>6</span>))
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>plot(x_interval, p_x(x_interval), c<span style=color:#555>=</span><span style=color:#c30>&#39;tab:blue&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>hist(X_sampled, density<span style=color:#555>=</span><span style=color:#069;font-weight:700>True</span>, bins <span style=color:#555>=</span> <span style=color:#f60>50</span>, color<span style=color:#555>=</span><span style=color:#c30>&#39;tab:blue&#39;</span>, alpha <span style=color:#555>=</span> <span style=color:#f60>0.5</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>plot(x_interval, y_x_func(x_interval), c<span style=color:#555>=</span><span style=color:#c30>&#39;tab:green&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>set(ylim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>1</span>], xlim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>10</span>])
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>text(<span style=color:#f60>8</span>, <span style=color:#f60>0.25</span>, <span style=color:#c30>&#39;$p_x(x)$&#39;</span>, color<span style=color:#555>=</span><span style=color:#c30>&#39;tab:blue&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>text(<span style=color:#f60>8</span>, <span style=color:#f60>0.9</span>, <span style=color:#c30>&#39;$y(x)$&#39;</span>, color<span style=color:#555>=</span><span style=color:#c30>&#39;tab:green&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>grid(axis<span style=color:#555>=</span><span style=color:#c30>&#39;both&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>set(xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$x$&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#555>.</span>set(ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$y$&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax2 <span style=color:#555>=</span> ax<span style=color:#555>.</span>twinx()
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>hist(Y, density<span style=color:#555>=</span><span style=color:#069;font-weight:700>True</span>, bins <span style=color:#555>=</span> <span style=color:#f60>50</span>, orientation<span style=color:#555>=</span><span style=color:#c30>&#34;horizontal&#34;</span>, color<span style=color:#555>=</span><span style=color:#c30>&#39;tab:orange&#39;</span>, alpha <span style=color:#555>=</span> <span style=color:#f60>0.5</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>plot(p_y(y_interval), y_interval, c<span style=color:#555>=</span><span style=color:#c30>&#39;tab:orange&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>plot(p_y_simple_transform(y_interval) <span style=color:#555>/</span> np<span style=color:#555>.</span>trapz(p_y_simple_transform(y_interval), y_interval), y_interval, c <span style=color:#555>=</span> <span style=color:#c30>&#39;tab:purple&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>set(ylim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>1</span>])
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>text(<span style=color:#f60>3.8</span>, <span style=color:#f60>0.9</span>, <span style=color:#c30>&#39;$p_y(y)$&#39;</span>, color<span style=color:#555>=</span><span style=color:#c30>&#39;tab:orange&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>grid(axis<span style=color:#555>=</span><span style=color:#c30>&#39;both&#39;</span>)
</span></span></code></pre></div></div></div><p><img src=output_14_1.png alt=png></p><h3 id=example-4>Example 4</h3><p>For the next example, let&rsquo;s consider coordinate transform.</p><p>The polar coordinate transforms two numbers $(r, \theta)$, where radial distance $r \in [0, \inf)$ and polar angle $\theta \in [0, 2\pi)$ to a point on a plane.
$$
\begin{align}
x = r \cos{\left(\theta \right)} \\
y = r \sin{\left(\theta \right)}
\end{align}
$$</p><p>Evaluating the derivatives we get:
$$
\begin{align}
\frac{\partial x}{\partial r} &= \cos(\phi) \\
\frac{\partial x}{\partial \phi} &= - r \sin(\phi) \\
\frac{\partial y}{\partial r} &= \sin(\phi) \\
\frac{\partial x}{\partial \phi} &= r \cos(\phi)
\end{align}
$$</p><p>We can view this transformation as a multivariate change of variables. In such a case instead of $\frac{dx}{dy}$ we use the determinant of Jacobian ($\mathbf{J}$) that describes how the volume changes under the transformation.</p><p>Now, if we sample a polar coordinate $(r, \theta)$ with probability $f(r, \theta)$, then the distribution $g(x, y)$ is given by:
$$
g(x, y) = \frac{f(r, \theta)}{\det\mathbf{J}} = \frac{f(r, \theta)}{r}.
$$</p><p>Now let&rsquo;s repeat an experiments. First let&rsquo;s take a look how the uniform grid changes after applying $x(r, \theta)$ and $y(r, \theta)$.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>matplotlib.pyplot</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>plt</span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>numpy</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>np</span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>from</span> <span style=color:#0cf;font-weight:700>scipy.stats</span> <span style=color:#069;font-weight:700>import</span> uniform, multivariate_normal
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># sample points uniformly in polar space</span>
</span></span><span style=display:flex><span>r_interval <span style=color:#555>=</span> np<span style=color:#555>.</span>linspace(<span style=color:#f60>1e-1</span>, <span style=color:#f60>2</span>, <span style=color:#f60>40</span>)
</span></span><span style=display:flex><span>theta_interval <span style=color:#555>=</span> np<span style=color:#555>.</span>linspace(<span style=color:#f60>0.0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi, <span style=color:#f60>40</span>)
</span></span><span style=display:flex><span>r, theta <span style=color:#555>=</span> np<span style=color:#555>.</span>meshgrid(r_interval, theta_interval)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># transform</span>
</span></span><span style=display:flex><span>x, y <span style=color:#555>=</span> r <span style=color:#555>*</span> np<span style=color:#555>.</span>cos(theta), r <span style=color:#555>*</span> np<span style=color:#555>.</span>sin(theta)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig <span style=color:#555>=</span> plt<span style=color:#555>.</span>figure(figsize<span style=color:#555>=</span>(<span style=color:#f60>9</span>, <span style=color:#f60>4</span>))
</span></span><span style=display:flex><span>ax1 <span style=color:#555>=</span> fig<span style=color:#555>.</span>add_subplot(<span style=color:#f60>131</span>)
</span></span><span style=display:flex><span>ax2 <span style=color:#555>=</span> fig<span style=color:#555>.</span>add_subplot(<span style=color:#f60>132</span>, polar<span style=color:#555>=</span><span style=color:#069;font-weight:700>True</span>)
</span></span><span style=display:flex><span>ax3 <span style=color:#555>=</span> fig<span style=color:#555>.</span>add_subplot(<span style=color:#f60>133</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax1<span style=color:#555>.</span>scatter(r, theta, s <span style=color:#555>=</span> <span style=color:#f60>10</span>, edgecolor<span style=color:#555>=</span><span style=color:#c30>&#39;none&#39;</span>, alpha <span style=color:#555>=</span> <span style=color:#f60>0.75</span>, marker<span style=color:#555>=</span><span style=color:#c30>&#39;.&#39;</span>, c <span style=color:#555>=</span> <span style=color:#c30>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax1<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span> [<span style=color:#f60>0</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi], xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$r$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$</span><span style=color:#c30;font-weight:700>\\</span><span style=color:#c30>theta$, rad&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>scatter(theta, r, s <span style=color:#555>=</span> <span style=color:#f60>10</span>, edgecolor<span style=color:#555>=</span><span style=color:#c30>&#39;none&#39;</span>, alpha <span style=color:#555>=</span> <span style=color:#f60>0.75</span>, marker<span style=color:#555>=</span><span style=color:#c30>&#39;.&#39;</span>, c <span style=color:#555>=</span> <span style=color:#c30>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>set_rmax(<span style=color:#f60>2</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>set_rticks([<span style=color:#f60>0.5</span>, <span style=color:#f60>1</span>, <span style=color:#f60>1.5</span>, <span style=color:#f60>2</span>])
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>set(xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$r$&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$</span><span style=color:#c30;font-weight:700>\\</span><span style=color:#c30>theta$&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax3<span style=color:#555>.</span>scatter(x, y, s <span style=color:#555>=</span> <span style=color:#f60>10</span>, edgecolor<span style=color:#555>=</span><span style=color:#c30>&#39;none&#39;</span>, alpha<span style=color:#555>=</span><span style=color:#f60>0.75</span>, marker<span style=color:#555>=</span><span style=color:#c30>&#39;.&#39;</span>, c <span style=color:#555>=</span> <span style=color:#c30>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax3<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span>[<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], aspect<span style=color:#555>=</span><span style=color:#c30>&#39;equal&#39;</span>, xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$x$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$y$, m&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig<span style=color:#555>.</span>tight_layout()
</span></span></code></pre></div></div></div><p><img src=output_19_0.png alt=png></p><p>And finally, let&rsquo;s draw samples from our $f(r, \theta)$ distribution, apply our transform, and plot the transformed samples. The top row of the plot displays the transformed samples, while the bottom row shows the $f(r, \theta)$ and $g(x, y)$ pdfs.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#09f;font-style:italic># pdf for r, theta multivariate distribution</span>
</span></span><span style=display:flex><span>f_rtheta <span style=color:#555>=</span> uniform(<span style=color:#f60>0</span>, <span style=color:#f60>2</span>)<span style=color:#555>.</span>pdf(r) <span style=color:#555>*</span> uniform(<span style=color:#f60>0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi)<span style=color:#555>.</span>pdf(theta)
</span></span><span style=display:flex><span>g_xy <span style=color:#555>=</span> f_rtheta <span style=color:#555>/</span> r
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, ax <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplots(<span style=color:#f60>2</span>, <span style=color:#f60>2</span>, figsize <span style=color:#555>=</span> (<span style=color:#f60>6</span>, <span style=color:#f60>7</span>))
</span></span><span style=display:flex><span>ax1 <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplot(<span style=color:#f60>221</span>)
</span></span><span style=display:flex><span>ax2 <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplot(<span style=color:#f60>222</span>)
</span></span><span style=display:flex><span>ax3 <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplot(<span style=color:#f60>223</span>)
</span></span><span style=display:flex><span>ax4 <span style=color:#555>=</span> plt<span style=color:#555>.</span>subplot(<span style=color:#f60>224</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r_sampled, theta_sampled <span style=color:#555>=</span> uniform(<span style=color:#f60>0</span>, <span style=color:#f60>2</span>)<span style=color:#555>.</span>rvs(size<span style=color:#555>=</span><span style=color:#f60>10000</span>), uniform(<span style=color:#f60>0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi)<span style=color:#555>.</span>rvs(size<span style=color:#555>=</span><span style=color:#f60>10000</span>)
</span></span><span style=display:flex><span>x_sampled, y_sampled <span style=color:#555>=</span> r_sampled <span style=color:#555>*</span> np<span style=color:#555>.</span>cos(theta_sampled), r_sampled <span style=color:#555>*</span> np<span style=color:#555>.</span>sin(theta_sampled)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax1<span style=color:#555>.</span>scatter(r_sampled, theta_sampled, s <span style=color:#555>=</span> <span style=color:#f60>10</span>, edgecolor<span style=color:#555>=</span><span style=color:#c30>&#39;none&#39;</span>, alpha <span style=color:#555>=</span> <span style=color:#f60>0.1</span>)
</span></span><span style=display:flex><span>ax1<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span> [<span style=color:#f60>0</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi], aspect<span style=color:#555>=</span><span style=color:#c30>&#39;equal&#39;</span>, xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$r$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$</span><span style=color:#c30;font-weight:700>\\</span><span style=color:#c30>theta$, rad&#39;</span>, title<span style=color:#555>=</span><span style=color:#c30>&#39;Samples&#39;</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>scatter(x_sampled, y_sampled, s <span style=color:#555>=</span> <span style=color:#f60>10</span>, edgecolor<span style=color:#555>=</span><span style=color:#c30>&#39;none&#39;</span>, alpha<span style=color:#555>=</span><span style=color:#f60>0.1</span>)
</span></span><span style=display:flex><span>ax2<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span> [<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], aspect<span style=color:#555>=</span><span style=color:#c30>&#39;equal&#39;</span>, xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$x$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$y$, m&#39;</span>, title<span style=color:#555>=</span><span style=color:#c30>&#39;Samples&#39;</span>)
</span></span><span style=display:flex><span>ax3<span style=color:#555>.</span>contourf(r, theta, f_rtheta, vmin<span style=color:#555>=</span><span style=color:#f60>0</span>, vmax <span style=color:#555>=</span> <span style=color:#f60>0.2</span>)
</span></span><span style=display:flex><span>ax3<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span> [<span style=color:#f60>0</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#f60>0</span>, <span style=color:#f60>2</span> <span style=color:#555>*</span> np<span style=color:#555>.</span>pi], aspect<span style=color:#555>=</span><span style=color:#c30>&#39;equal&#39;</span>, xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$r$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$</span><span style=color:#c30;font-weight:700>\\</span><span style=color:#c30>theta$, rad&#39;</span>, title<span style=color:#555>=</span><span style=color:#c30>&#39;pdf&#39;</span>)
</span></span><span style=display:flex><span>cf <span style=color:#555>=</span> ax4<span style=color:#555>.</span>contourf(x, y, g_xy, vmin<span style=color:#555>=</span><span style=color:#f60>0</span>, vmax <span style=color:#555>=</span> <span style=color:#f60>0.2</span>, extend<span style=color:#555>=</span><span style=color:#c30>&#39;max&#39;</span>, cmap<span style=color:#555>=</span><span style=color:#c30>&#39;viridis&#39;</span>)
</span></span><span style=display:flex><span>ax4<span style=color:#555>.</span>set(xlim <span style=color:#555>=</span> [<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], ylim<span style=color:#555>=</span>[<span style=color:#555>-</span><span style=color:#f60>2</span>, <span style=color:#f60>2</span>], aspect<span style=color:#555>=</span><span style=color:#c30>&#39;equal&#39;</span>, xlabel<span style=color:#555>=</span><span style=color:#c30>&#39;$x$, m&#39;</span>, ylabel<span style=color:#555>=</span><span style=color:#c30>&#39;$y$, m&#39;</span>, title<span style=color:#555>=</span><span style=color:#c30>&#39;pdf&#39;</span>)
</span></span><span style=display:flex><span>fig<span style=color:#555>.</span>colorbar(cf, ax<span style=color:#555>=</span>(ax1, ax2, ax3, ax4), orientation<span style=color:#555>=</span><span style=color:#c30>&#39;horizontal&#39;</span>)
</span></span></code></pre></div></div></div><p><img src=output_21_1.png alt=png></p><h2 id=references>References</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.bishopbook.com/>https://www.bishopbook.com/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_(Siegrist)/03%3A_Distributions/3.07%3A_Transformations_of_Random_Variables>https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_(Siegrist)/03%3A_Distributions/3.07%3A_Transformations_of_Random_Variables</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob11.pdf>https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob11.pdf</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://www.cs.cornell.edu/courses/cs6630/2015fa/notes/pdf-transform.pdf>https://www.cs.cornell.edu/courses/cs6630/2015fa/notes/pdf-transform.pdf</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://stats.stackexchange.com/questions/14483/intuitive-explanation-for-density-of-transformed-variable>https://stats.stackexchange.com/questions/14483/intuitive-explanation-for-density-of-transformed-variable</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mikoff-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script></section></div><footer class=footer><section class=container>© 2024
Aleksandr Mikoff
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer><script src=//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js></script></main></body></html>