<!doctype html><html lang=en><head><title>Probability density transform · Aleksandr Mikoff's blog
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Aleksandr Mikoff"><meta name=description content="PDF transformations Link to heading While reading new [book]1 by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]2, [3]3, [4]4, [5]5."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Probability density transform"><meta name=twitter:description content="PDF transformations Link to heading While reading new [book]1 by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]2, [3]3, [4]4, [5]5."><meta property="og:title" content="Probability density transform"><meta property="og:description" content="PDF transformations Link to heading While reading new [book]1 by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]2, [3]3, [4]4, [5]5."><meta property="og:type" content="article"><meta property="og:url" content="https://mikoff.github.io/posts/probability-density-transform/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-27T12:00:00+03:00"><meta property="article:modified_time" content="2024-01-27T12:00:00+03:00"><link rel=canonical href=https://mikoff.github.io/posts/probability-density-transform/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/image.min.c1a5dfc6bac0eb1b85bcd8abf8aba0d18e0bf02fc972f9a0b17d2962f5ca8dd5.css integrity="sha256-waXfxrrA6xuFvNir+Kug0Y4L8C/JcvmgsX0pYvXKjdU=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/spoiler.min.bf901294afff95f520a8150a4df4249576eb9c49c4f40f5f9c2de750588dd594.css integrity="sha256-v5ASlK//lfUgqBUKTfQklXbrnEnE9A9fnC3nUFiN1ZQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/plugins/academic-icons/css/academicons.min.f6abb61f6b9b2e784eba22dfb93cd399ce30ee01825791830a2737d6bfcd2be9.css integrity="sha256-9qu2H2ubLnhOuiLfuTzTmc4w7gGCV5GDCic31r/NK+k=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://mikoff.github.io/>Aleksandr Mikoff's blog
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/tags>Tags</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://mikoff.github.io/posts/probability-density-transform/>Probability density transform</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-01-27T12:00:00+03:00>January 27, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
7-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/pdf/>Pdf</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/probability/>Probability</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/transform/>Transform</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/deep-learning/>Deep Learning</a></span></div></div></header><div class=post-content><h1 id=pdf-transformations>PDF transformations
<a class=heading-link href=#pdf-transformations><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>While reading new [book]<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> by Bishop I came across pdf transformation topic. It turned out to be counter-intuitive that we need not only transform the pdf by the selected function, but also multiply it by the derivative of the inverse function w.r.t. substituted variable. While delving into the details of this topic, I found the following sources to be quite useful: [2]<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, [3]<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, [4]<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>, [5]<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>.</p><h2 id=introduction>Introduction
<a class=heading-link href=#introduction><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Assume that we have random variable $X$ that has a continuous distribution on an interval $S \in \mathcal{R}$, its probability density function $f(x)$ is known. Suppose that we have a differentiable function $y$ from $S$ to $T \in \mathcal{R}$ and we apply this function to random variable $X$. We end up having a new random variable $Y = y(X)$. The question is how can we find the distribution of our random variable $Y$?</p><h2 id=the-main-theorem>The main theorem
<a class=heading-link href=#the-main-theorem><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>We know, by definition of probability that:</p>$$
P(a \leq X < b) = \int_a^b f(x) dx.
$$<p>Now, if $X = a$ the derived random variable $Y = y(a)$ and if $X = b$, $Y = y(b)$. Hence:</p>$$
P(y(a) \leq Y < y(b)) = P(a \leq X < b) = \int_a^b f(x)dx = \int_{y(a)}^{y(b)}f(x(y))\frac{dx}{dy} dy.
$$<p>In the last step we used the integration by substitution method, $x(y)$ is $x$ expressed in terms of $y$.</p><p>The right-hand integrand $f(x(y))\frac{dx}{dy}$ is expressed wholly in terms of y, so can be replaced by function $g(y)$:</p>$$
P(y(a) \leq Y < y(b)) = \int_{y(a)}^{y(b)} g(y) dy,
$$<p>making it obvious that $g(y)$ is the pdf associated with $Y$.</p><p>Now, taking the derivative, we have</p>$$
g(y) = f(x(y)) \left|\frac{dx}{dy}\right|.
$$<p>Here we have an absolute value because the formula is the same for increasing or decreasing $g$.</p><p>While being compact, this formula is less clear. We must remember that $x$ on the ride side should be written in terms of $y$, but since we originally express $y$ in terms of $x$: $Y = y(X)$, the inverse function should be used there.</p><p>To be a little bit more explicit let&rsquo;s rewrite this equation using arbitrary function $r$: $y = r(x)$ applied to variable $x$, and giving back variable $y$, the aforementioned formula can be rendered as follows:</p>$$
g(y) = f(r^{-1}(y))\left|\frac{d}{dy}r^{-1}(y)\right|.
$$<p>What this formula states is that any density $g(y)$ can be obtained from a fixed density $f(x)$.</p><h3 id=example-1>Example 1
<a class=heading-link href=#example-1><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Suppose that $Y = a + bX$, $a \in \mathcal{R}$ and $b \in \mathcal{R} \backslash \{0\}$, the distribution of $X$ is known: $f(x)$. What is the pdf of $Y$?</p><p>Since $r(x) = y = a + bx$, we can find inverse function to be $r^{-1}(y) = x = \frac{y - a}{b}$ and the derivative $\frac{dx}{dy} = \frac{1}{b}$.</p><p>Then $g(y) = f(\frac{y - a}{b})\frac{1}{|b|}$.</p><h3 id=example-2>Example 2
<a class=heading-link href=#example-2><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Suppose that $f(x) = 2 x, x \in [0, 1)$ and $y(x) = x^2$.</p><p>First, derive the inverse of the function $x(y) = \sqrt{y}$.</p><p>Now, having:</p>$$
\begin{align}
f(x(y)) = 2 \sqrt{y}~\text{and}~ \frac{dx}{dy} = \frac{1}{2\sqrt{y}}
\end{align}
$$<p>we can find $g(y)$ to be:</p>$$
g(y) = f(x(y)) \left|\frac{dx}{dy}\right| = 2 \sqrt{y} \frac{1}{2\sqrt{y}} = 1.
$$<p>So after applying transformation $y(x) = x^2$ to random variable $X$ the function $y(x)$ transforms the triangular distribution into the uniform one.</p><h3 id=example-3>Example 3
<a class=heading-link href=#example-3><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Given random variable $X \sim \mathcal{N}(6.5, 1.)$ we apply to it transformation function $y(x)$ specified as:</p>$$
y(x) = \frac{1}{1 + \exp(5 - x)}.
$$<p>Let $Y = y(X)$, and $p(y)$ be the pdf associated with $Y$. What is the pdf of $p(y)$?</p><p>Let&rsquo;s solve the problem using <code>sympy</code>:</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> sympy <span style=color:#fff;font-weight:700>as</span> sp
</span></span><span style=display:flex><span>x = sp.Symbol(<span style=color:#0ff;font-weight:700>&#39;x&#39;</span>, positive=<span style=color:#fff;font-weight:700>True</span>)
</span></span><span style=display:flex><span>y = sp.Symbol(<span style=color:#0ff;font-weight:700>&#39;y&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>y_x = <span style=color:#ff0;font-weight:700>1.</span> / (<span style=color:#ff0;font-weight:700>1.</span> + sp.exp(<span style=color:#ff0;font-weight:700>5</span> - x))
</span></span><span style=display:flex><span>x_y = sp.solve(y_x - y, x)[<span style=color:#ff0;font-weight:700>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dx_dy = x_y.diff(y).simplify()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># print(sp.latex(x_y), sp.latex(dx_dy))</span>
</span></span></code></pre></div></div></div><p>After solving for $y$ and finding the derivative we got:</p>$$
\begin{align}
x(y) = \log{\left(- \frac{y}{y - 1.0} \right)} + 5.0 ~\text{and}~ \frac{dx}{dy} = -\frac{1.0}{y \left(y - 1\right)}
\end{align}
$$<div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> sympy.stats
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>X = sp.stats.Normal(<span style=color:#0ff;font-weight:700>&#39;x&#39;</span>, <span style=color:#ff0;font-weight:700>6.5</span>, <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>pdf_x = sp.stats.density(X)(x)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pdf_y_simple_transform = pdf_x.subs({x:x_y})
</span></span><span style=display:flex><span>pdf_y = (pdf_x * dx_dy).subs({x:x_y})
</span></span><span style=display:flex><span><span style=color:#007f7f># print(sp.latex(pdf_y))</span>
</span></span></code></pre></div></div></div><p>Giving the following $p(y)$:</p>$$
p(y) = - \frac{0.5 \sqrt{2} e^{- 1.125 \left(0.666666666666667 \log{\left(- \frac{y}{y - 1.0} \right)} - 1\right)^{2}}}{\sqrt{\pi} y \left(y - 1\right)}
$$<p>Now let&rsquo;s plot everything. First let&rsquo;s plot $p(x)$ and draw samples from $X$ distribution, plotting the histogram of their values (blue).</p><p>Next, let&rsquo;s apply the function $y(x)$ to each sample from the drawn set and plot its histogram too (orange).</p><p>If we substitute $x$ by $y$ in $p(x)$, we will obtain a purple curve. However, this curve does not agree with the histogram!</p><p>The correct curve for $p(y)$ density is shown in orange. In this case, in addition to substitution, we multiplied the result by $\frac{dx}{dy}$ to obtain the correct result.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> numpy <span style=color:#fff;font-weight:700>as</span> np
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> scipy.stats <span style=color:#fff;font-weight:700>import</span> norm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># lambdify pdfs</span>
</span></span><span style=display:flex><span>p_x = sp.lambdify(x, pdf_x)
</span></span><span style=display:flex><span>p_y_simple_transform = sp.lambdify(y, pdf_y_simple_transform)
</span></span><span style=display:flex><span>p_y = sp.lambdify(y, pdf_y)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># lambdify functions</span>
</span></span><span style=display:flex><span>y_x_func = sp.lambdify(x, y_x, modules = [<span style=color:#0ff;font-weight:700>&#34;numpy&#34;</span>])
</span></span><span style=display:flex><span>x_y_func = sp.lambdify(y, x_y)
</span></span><span style=display:flex><span>dx_dy_func = sp.lambdify(y, dx_dy)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x_interval = np.arange(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>10</span>, <span style=color:#ff0;font-weight:700>0.1</span>)
</span></span><span style=display:flex><span>y_interval = np.linspace(<span style=color:#ff0;font-weight:700>0.0</span>, <span style=color:#ff0;font-weight:700>1.0</span>, <span style=color:#ff0;font-weight:700>1000</span>, endpoint=<span style=color:#fff;font-weight:700>False</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># sample X from our distribution</span>
</span></span><span style=display:flex><span>X_sampled = norm(<span style=color:#ff0;font-weight:700>6.5</span>, <span style=color:#ff0;font-weight:700>1.</span>).rvs(size = <span style=color:#ff0;font-weight:700>100000</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f># transform the values</span>
</span></span><span style=display:flex><span>Y = y_x_func(X_sampled)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> matplotlib.pyplot <span style=color:#fff;font-weight:700>as</span> plt
</span></span><span style=display:flex><span>%matplotlib inline
</span></span><span style=display:flex><span>%config InlineBackend.figure_format=<span style=color:#0ff;font-weight:700>&#39;retina&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, ax = plt.subplots(<span style=color:#ff0;font-weight:700>1</span>, <span style=color:#ff0;font-weight:700>1</span>, figsize=(<span style=color:#ff0;font-weight:700>6</span>, <span style=color:#ff0;font-weight:700>6</span>))
</span></span><span style=display:flex><span>ax.plot(x_interval, p_x(x_interval), c=<span style=color:#0ff;font-weight:700>&#39;tab:blue&#39;</span>)
</span></span><span style=display:flex><span>ax.hist(X_sampled, density=<span style=color:#fff;font-weight:700>True</span>, bins = <span style=color:#ff0;font-weight:700>50</span>, color=<span style=color:#0ff;font-weight:700>&#39;tab:blue&#39;</span>, alpha = <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>ax.plot(x_interval, y_x_func(x_interval), c=<span style=color:#0ff;font-weight:700>&#39;tab:green&#39;</span>)
</span></span><span style=display:flex><span>ax.set(ylim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>1</span>], xlim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>10</span>])
</span></span><span style=display:flex><span>ax.text(<span style=color:#ff0;font-weight:700>8</span>, <span style=color:#ff0;font-weight:700>0.25</span>, <span style=color:#0ff;font-weight:700>&#39;$p_x(x)$&#39;</span>, color=<span style=color:#0ff;font-weight:700>&#39;tab:blue&#39;</span>)
</span></span><span style=display:flex><span>ax.text(<span style=color:#ff0;font-weight:700>8</span>, <span style=color:#ff0;font-weight:700>0.9</span>, <span style=color:#0ff;font-weight:700>&#39;$y(x)$&#39;</span>, color=<span style=color:#0ff;font-weight:700>&#39;tab:green&#39;</span>)
</span></span><span style=display:flex><span>ax.grid(axis=<span style=color:#0ff;font-weight:700>&#39;both&#39;</span>)
</span></span><span style=display:flex><span>ax.set(xlabel=<span style=color:#0ff;font-weight:700>&#39;$x$&#39;</span>)
</span></span><span style=display:flex><span>ax.set(ylabel=<span style=color:#0ff;font-weight:700>&#39;$y$&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax2 = ax.twinx()
</span></span><span style=display:flex><span>ax2.hist(Y, density=<span style=color:#fff;font-weight:700>True</span>, bins = <span style=color:#ff0;font-weight:700>50</span>, orientation=<span style=color:#0ff;font-weight:700>&#34;horizontal&#34;</span>, color=<span style=color:#0ff;font-weight:700>&#39;tab:orange&#39;</span>, alpha = <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>ax2.plot(p_y(y_interval), y_interval, c=<span style=color:#0ff;font-weight:700>&#39;tab:orange&#39;</span>)
</span></span><span style=display:flex><span>ax2.plot(p_y_simple_transform(y_interval) / np.trapz(p_y_simple_transform(y_interval), y_interval), y_interval, c = <span style=color:#0ff;font-weight:700>&#39;tab:purple&#39;</span>)
</span></span><span style=display:flex><span>ax2.set(ylim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>1</span>])
</span></span><span style=display:flex><span>ax2.text(<span style=color:#ff0;font-weight:700>3.8</span>, <span style=color:#ff0;font-weight:700>0.9</span>, <span style=color:#0ff;font-weight:700>&#39;$p_y(y)$&#39;</span>, color=<span style=color:#0ff;font-weight:700>&#39;tab:orange&#39;</span>)
</span></span><span style=display:flex><span>ax2.grid(axis=<span style=color:#0ff;font-weight:700>&#39;both&#39;</span>)
</span></span></code></pre></div></div></div><p><img src=output_14_1.png alt=png></p><h3 id=example-4>Example 4
<a class=heading-link href=#example-4><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>For the next example, let&rsquo;s consider coordinate transform.</p><p>The polar coordinate transforms two numbers $(r, \theta)$, where radial distance $r \in [0, \inf)$ and polar angle $\theta \in [0, 2\pi)$ to a point on a plane.</p>$$
\begin{align}
x = r \cos{\left(\theta \right)} \\\\
y = r \sin{\left(\theta \right)}
\end{align}
$$<p>Evaluating the derivatives we get:</p>$$
\begin{align}
\frac{\partial x}{\partial r} &= \cos(\phi) \\\\
\frac{\partial x}{\partial \phi} &= - r \sin(\phi) \\\\
\frac{\partial y}{\partial r} &= \sin(\phi) \\\\
\frac{\partial x}{\partial \phi} &= r \cos(\phi)
\end{align}
$$<p>We can view this transformation as a multivariate change of variables. In such a case instead of $\frac{dx}{dy}$ we use the determinant of Jacobian ($\mathbf{J}$) that describes how the volume changes under the transformation.</p><p>Now, if we sample a polar coordinate $(r, \theta)$ with probability $f(r, \theta)$, then the distribution $g(x, y)$ is given by:</p>$$
g(x, y) = \frac{f(r, \theta)}{\det\mathbf{J}} = \frac{f(r, \theta)}{r}.
$$<p>Now let&rsquo;s repeat an experiments. First let&rsquo;s take a look how the uniform grid changes after applying $x(r, \theta)$ and $y(r, \theta)$.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> matplotlib.pyplot <span style=color:#fff;font-weight:700>as</span> plt
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> numpy <span style=color:#fff;font-weight:700>as</span> np
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> scipy.stats <span style=color:#fff;font-weight:700>import</span> uniform, multivariate_normal
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># sample points uniformly in polar space</span>
</span></span><span style=display:flex><span>r_interval = np.linspace(<span style=color:#ff0;font-weight:700>1e-1</span>, <span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>40</span>)
</span></span><span style=display:flex><span>theta_interval = np.linspace(<span style=color:#ff0;font-weight:700>0.0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi, <span style=color:#ff0;font-weight:700>40</span>)
</span></span><span style=display:flex><span>r, theta = np.meshgrid(r_interval, theta_interval)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># transform</span>
</span></span><span style=display:flex><span>x, y = r * np.cos(theta), r * np.sin(theta)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig = plt.figure(figsize=(<span style=color:#ff0;font-weight:700>9</span>, <span style=color:#ff0;font-weight:700>4</span>))
</span></span><span style=display:flex><span>ax1 = fig.add_subplot(<span style=color:#ff0;font-weight:700>131</span>)
</span></span><span style=display:flex><span>ax2 = fig.add_subplot(<span style=color:#ff0;font-weight:700>132</span>, polar=<span style=color:#fff;font-weight:700>True</span>)
</span></span><span style=display:flex><span>ax3 = fig.add_subplot(<span style=color:#ff0;font-weight:700>133</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax1.scatter(r, theta, s = <span style=color:#ff0;font-weight:700>10</span>, edgecolor=<span style=color:#0ff;font-weight:700>&#39;none&#39;</span>, alpha = <span style=color:#ff0;font-weight:700>0.75</span>, marker=<span style=color:#0ff;font-weight:700>&#39;.&#39;</span>, c = <span style=color:#0ff;font-weight:700>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax1.set(xlim = [<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi], xlabel=<span style=color:#0ff;font-weight:700>&#39;$r$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$</span><span style=color:#0ff;font-weight:700>\\</span><span style=color:#0ff;font-weight:700>theta$, rad&#39;</span>)
</span></span><span style=display:flex><span>ax2.scatter(theta, r, s = <span style=color:#ff0;font-weight:700>10</span>, edgecolor=<span style=color:#0ff;font-weight:700>&#39;none&#39;</span>, alpha = <span style=color:#ff0;font-weight:700>0.75</span>, marker=<span style=color:#0ff;font-weight:700>&#39;.&#39;</span>, c = <span style=color:#0ff;font-weight:700>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax2.set_rmax(<span style=color:#ff0;font-weight:700>2</span>)
</span></span><span style=display:flex><span>ax2.set_rticks([<span style=color:#ff0;font-weight:700>0.5</span>, <span style=color:#ff0;font-weight:700>1</span>, <span style=color:#ff0;font-weight:700>1.5</span>, <span style=color:#ff0;font-weight:700>2</span>])
</span></span><span style=display:flex><span>ax2.set(xlabel=<span style=color:#0ff;font-weight:700>&#39;$r$&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$</span><span style=color:#0ff;font-weight:700>\\</span><span style=color:#0ff;font-weight:700>theta$&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax3.scatter(x, y, s = <span style=color:#ff0;font-weight:700>10</span>, edgecolor=<span style=color:#0ff;font-weight:700>&#39;none&#39;</span>, alpha=<span style=color:#ff0;font-weight:700>0.75</span>, marker=<span style=color:#0ff;font-weight:700>&#39;.&#39;</span>, c = <span style=color:#0ff;font-weight:700>&#39;tab:red&#39;</span>)
</span></span><span style=display:flex><span>ax3.set(xlim =[-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], aspect=<span style=color:#0ff;font-weight:700>&#39;equal&#39;</span>, xlabel=<span style=color:#0ff;font-weight:700>&#39;$x$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$y$, m&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig.tight_layout()
</span></span></code></pre></div></div></div><p><img src=output_19_0.png alt=png></p><p>And finally, let&rsquo;s draw samples from our $f(r, \theta)$ distribution, apply our transform, and plot the transformed samples. The top row of the plot displays the transformed samples, while the bottom row shows the $f(r, \theta)$ and $g(x, y)$ pdfs.</p><div class=spoiler><span class=spoilerText>Spoiler</span>
<input class=spoilerChecked type=checkbox showtext=Code><div class=spoilerContent><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007f7f># pdf for r, theta multivariate distribution</span>
</span></span><span style=display:flex><span>f_rtheta = uniform(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span>).pdf(r) * uniform(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi).pdf(theta)
</span></span><span style=display:flex><span>g_xy = f_rtheta / r
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, ax = plt.subplots(<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>, figsize = (<span style=color:#ff0;font-weight:700>6</span>, <span style=color:#ff0;font-weight:700>7</span>))
</span></span><span style=display:flex><span>ax1 = plt.subplot(<span style=color:#ff0;font-weight:700>221</span>)
</span></span><span style=display:flex><span>ax2 = plt.subplot(<span style=color:#ff0;font-weight:700>222</span>)
</span></span><span style=display:flex><span>ax3 = plt.subplot(<span style=color:#ff0;font-weight:700>223</span>)
</span></span><span style=display:flex><span>ax4 = plt.subplot(<span style=color:#ff0;font-weight:700>224</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r_sampled, theta_sampled = uniform(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span>).rvs(size=<span style=color:#ff0;font-weight:700>10000</span>), uniform(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi).rvs(size=<span style=color:#ff0;font-weight:700>10000</span>)
</span></span><span style=display:flex><span>x_sampled, y_sampled = r_sampled * np.cos(theta_sampled), r_sampled * np.sin(theta_sampled)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax1.scatter(r_sampled, theta_sampled, s = <span style=color:#ff0;font-weight:700>10</span>, edgecolor=<span style=color:#0ff;font-weight:700>&#39;none&#39;</span>, alpha = <span style=color:#ff0;font-weight:700>0.1</span>)
</span></span><span style=display:flex><span>ax1.set(xlim = [<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi], aspect=<span style=color:#0ff;font-weight:700>&#39;equal&#39;</span>, xlabel=<span style=color:#0ff;font-weight:700>&#39;$r$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$</span><span style=color:#0ff;font-weight:700>\\</span><span style=color:#0ff;font-weight:700>theta$, rad&#39;</span>, title=<span style=color:#0ff;font-weight:700>&#39;Samples&#39;</span>)
</span></span><span style=display:flex><span>ax2.scatter(x_sampled, y_sampled, s = <span style=color:#ff0;font-weight:700>10</span>, edgecolor=<span style=color:#0ff;font-weight:700>&#39;none&#39;</span>, alpha=<span style=color:#ff0;font-weight:700>0.1</span>)
</span></span><span style=display:flex><span>ax2.set(xlim = [-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], aspect=<span style=color:#0ff;font-weight:700>&#39;equal&#39;</span>, xlabel=<span style=color:#0ff;font-weight:700>&#39;$x$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$y$, m&#39;</span>, title=<span style=color:#0ff;font-weight:700>&#39;Samples&#39;</span>)
</span></span><span style=display:flex><span>ax3.contourf(r, theta, f_rtheta, vmin=<span style=color:#ff0;font-weight:700>0</span>, vmax = <span style=color:#ff0;font-weight:700>0.2</span>)
</span></span><span style=display:flex><span>ax3.set(xlim = [<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>2</span> * np.pi], aspect=<span style=color:#0ff;font-weight:700>&#39;equal&#39;</span>, xlabel=<span style=color:#0ff;font-weight:700>&#39;$r$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$</span><span style=color:#0ff;font-weight:700>\\</span><span style=color:#0ff;font-weight:700>theta$, rad&#39;</span>, title=<span style=color:#0ff;font-weight:700>&#39;pdf&#39;</span>)
</span></span><span style=display:flex><span>cf = ax4.contourf(x, y, g_xy, vmin=<span style=color:#ff0;font-weight:700>0</span>, vmax = <span style=color:#ff0;font-weight:700>0.2</span>, extend=<span style=color:#0ff;font-weight:700>&#39;max&#39;</span>, cmap=<span style=color:#0ff;font-weight:700>&#39;viridis&#39;</span>)
</span></span><span style=display:flex><span>ax4.set(xlim = [-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], ylim=[-<span style=color:#ff0;font-weight:700>2</span>, <span style=color:#ff0;font-weight:700>2</span>], aspect=<span style=color:#0ff;font-weight:700>&#39;equal&#39;</span>, xlabel=<span style=color:#0ff;font-weight:700>&#39;$x$, m&#39;</span>, ylabel=<span style=color:#0ff;font-weight:700>&#39;$y$, m&#39;</span>, title=<span style=color:#0ff;font-weight:700>&#39;pdf&#39;</span>)
</span></span><span style=display:flex><span>fig.colorbar(cf, ax=(ax1, ax2, ax3, ax4), orientation=<span style=color:#0ff;font-weight:700>&#39;horizontal&#39;</span>)
</span></span></code></pre></div></div></div><p><img src=output_21_1.png alt=png></p><h2 id=references>References
<a class=heading-link href=#references><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.bishopbook.com/ class=external-link target=_blank rel=noopener>https://www.bishopbook.com/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_%28Siegrist%29/03%3A_Distributions/3.07%3A_Transformations_of_Random_Variables class=external-link target=_blank rel=noopener>https://stats.libretexts.org/Bookshelves/Probability_Theory/Probability_Mathematical_Statistics_and_Stochastic_Processes_(Siegrist)/03%3A_Distributions/3.07%3A_Transformations_of_Random_Variables</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob11.pdf class=external-link target=_blank rel=noopener>https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob11.pdf</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://www.cs.cornell.edu/courses/cs6630/2015fa/notes/pdf-transform.pdf class=external-link target=_blank rel=noopener>https://www.cs.cornell.edu/courses/cs6630/2015fa/notes/pdf-transform.pdf</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://stats.stackexchange.com/questions/14483/intuitive-explanation-for-density-of-transformed-variable class=external-link target=_blank rel=noopener>https://stats.stackexchange.com/questions/14483/intuitive-explanation-for-density-of-transformed-variable</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mikoff-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}(),document.addEventListener("themeChanged",function(){document.readyState=="complete"&&DISQUS.reset({reload:!0,config:disqus_config})})</script></footer></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script></section></div><footer class=footer><section class=container>©
2024
Aleksandr Mikoff
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>